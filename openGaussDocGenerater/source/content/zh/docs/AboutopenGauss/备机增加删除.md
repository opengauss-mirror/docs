# 备机增加删除

## 可获得性<a name="section118411122194813"></a>

本特性自openGauss 2.0.0版本开始引入。

## 特性简介<a name="section13375160194919"></a>

支持新增和删除备节点。

## 客户价值<a name="section19340161511499"></a>

当主库的读取压力较大，或者用户想要提升数据库灾难恢复能力，需要新增备节点。当集群中的某些备节点发生故障无法短时间内进行修复时，为保证集群状态正常，用户可以先将故障节点删除。

## 特性描述<a name="section54601932194912"></a>

openGauss支持从单机或者一主多备最多扩容至一主八备，支持新增级联备机，支持在集群中存在故障备机的情况下新增备节点；支持从一主多备删除至单节点，支持备机故障的情况下将其删除。

支持在线新增和删除备节点，即可以在不影响主机业务的情况下进行新增和删除备节点。

## 特性增强<a name="section1658716245019"></a>

无。

## 特性约束<a name="section13118121915014"></a>

新增备机的约束：

-   数据库主机上存在openGauss镜像包。

-   在新增的扩容备机上创建好与主机上相同的用户和用户组。

-   已存在的数据库节点和新增的扩容节点之间需要建立好root用户互信以及数据库管理用户的互信。

-   正确配置xml文件，在已安装数据库配置文件的基础上，添加需要扩容的备机信息。

-   只能使用root用户执行扩容命令。

-   不允许同时在主节点上执行gs\_dropnode命令删除其他备机。
-   执行扩容命令前需要导入主机数据库的环境变量。

-   扩容备机的操作系统与主机保持一致。

-   操作过程中不允许同时在其他备节点上执行主备倒换或者故障倒换的操作。

删除备机的约束：

-   删除备节点的操作只能在主节点上执行。
-   操作过程中不允许同时在其他备节点上执行主备倒换或者故障倒换的操作。
-   不允许同时在主节点上执行gs\_expansion命令进行扩容。
-   不允许同时执行2次相同的gs\_dropnode命令。
-   执行删除操作前，需要确保主节点和备节点之间建立好数据库管理用户的互信。
-   需要使用数据库管理用户执行该命令。
-   执行命令前需要通过source命令导入主机数据库的环境变量。

## 依赖关系<a name="section24082349505"></a>

无。

