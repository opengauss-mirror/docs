# 级联备机

## 可获得性<a name="section56086982"></a>

本特性自openGauss 1.1.0版本开始引入。

## 特性简介<a name="section35020791"></a>

本特性主要基于当前一主多备的架构，在此基础上，支持级联备机连接备机。

## 客户价值<a name="section46751668"></a>

一主多备架构在特殊业务场景下，无法支持足够灵活的结构。多机房部署，不足以满足HA切换下的完整结构（主次机房三个实例，次次机房两到三个实例）。若备机个数变多，对主机可能导致压力较大。针对业务实时性要求较低的查询，可落到级联备中。因此，我们需要提供级联备能力。

## 特性描述<a name="section18111828"></a>

主机通过发送日志给备机实现同步，备机通过发送日志给级联备实现同步，其中主备之间日志同步可配置为同步或异步，备机与级联备之间只能以异步方式。

目前一主多备方式架构，主机通过walsender线程向备机同步日志，备机通过walreceiver线程接受日志，并刷到本地盘，备机读取redo日志，完成主备之间的数据同步。主备机之间walsender与walreceiver一一对应。备机与级联备通过walsender与walreceiver线程异步方式同步日志，降低主机流复制的压力。

## 特性增强<a name="section28788730"></a>

无。

## 特性约束<a name="section06531946143616"></a>

-   级联备只能从备机同步数据，不能直接从主机同步。
-   级联备不支持直接从备机build数据，目前只能从主机build数据。如果备机需要全量build，会导致级联备也要重新全量build。
-   级联备为异步同步。
-   级联备不支持promote。
-   级联备不支持notify。
-   目前不提供查询主 - 备 - 级联备集群总体架构，需要根据主找到备，再通过备找到级联备。
-   级联备不能有再次级联备。
-   极致RTO开启时，不支持级联备。

## 依赖关系<a name="section57771982"></a>

无。

