# 约束设计

## DEFAULT和NULL约束<a name="section555838816718"></a>

-   【建议】如果能够从业务层面补全字段值，那么，就不建议使用DEFAULT约束，避免数据加载时产生不符合预期的结果。
-   【建议】给明确不存在NULL值的字段加上NOT NULL约束，优化器会在特定场景下对其进行自动优化。
-   【建议】给可以显式命名的约束显式命名。除了NOT NULL和DEFAULT约束外，其他约束都可以显式命名。

## 局部聚簇<a name="section2578598416718"></a>

Partial Cluster Key（局部聚簇，简称PCK）是列存表的一种局部聚簇技术，在openGauss中，使用PCK可以通过min/max稀疏索引实现事实表快速过滤扫描。PCK的选取遵循以下原则：

-   【关注】一张表上只能建立一个PCK，一个PCK可以包含多列，但是一般不建议超过2列。
-   【建议】在查询中的简单表达式过滤条件上创建PCK。这种过滤条件一般形如col op const，其中col为列名，op为操作符 =、\>、\>=、<=、<，const为常量值。
-   【建议】在满足上面条件的前提下，选择distinct值比较多的列上建PCK。

## 唯一约束<a name="section958094516718"></a>

-   【关注】行存表、列存表均支持唯一约束。
-   【建议】从命名上明确标识唯一约束，例如，命名为“UNI+构成字段”。

## 主键约束<a name="section3696271616719"></a>

-   【关注】行存表、列存表均支持主键约束。
-   【建议】从命名上明确标识主键约束，例如，将主键约束命名为 “PK+字段名”。

## 外键约束<a name="section3696271616720"></a>

-   【关注】行存表支持外键约束，列存表不支持外键约束。
-   【建议】从命名上明确标识外键约束，例如，将外键约束命名为 “FK+字段名”。

## 检查约束<a name="section45602286161148"></a>

-   【关注】行存表支持检查约束，而列存表不支持。
-   【建议】从命名上明确标识检查约束，例如，将检查约束命名为 “CK+字段名”。

