# 向量数据类型

**表 1**  向量类型
DataVec向量引擎所支持的向量数据类型。

名称 | 存储空间 | 维度限制 | 描述
--- | --- | --- | --- 
vector | (4 * 维度 + 8字节)字节 | 1/16,000 | 单精度浮点数向量
bit | (维度 / 8 + 8)字节 | 1/83,886,080 | 位向量
sparsevec | (8 * 非零元素数 + 16)字节 | 1/1,000,000,000<br>最大非零元素数:16,000 | 稀疏向量

>![](public_sys-resources/icon-note.png) **说明：**
>上述维度限制只限于向量数据存储以及向量计算，并不包含向量索引的维度限制，索引支持的向量维度请参考[向量索引](../SQLReference/向量索引.md)。
> 上述维度限制局限于Toast表。

非Toast表维度限制：
名称  | 维度限制 
---  | --- 
vector | 1/2,029 
bit | 1/694,896
sparsevec | 1/1,000,000,000<br>最大非零元素数:1,013 

## Vector
每个vector占用 `4 * 维度 + 8` 字节的储存空间。
每个元素都是单精度浮点数，有效小数位约为并且所有的元素都是有限的：（不能为 `NaN`，`Infinity` 或者 `-Infinity`）。
vector的最大维度为 `16,000`。

### 格式
```
['<ELEMENT>', ..., '<ELEMENT>']::vector
```
- ELEMENT - 元素

**示例1：**
```
openGauss=# SELECT '[1,2,3]'::vector;
 vector  
---------
 [1,2,3]
(1 row)
```

>![](public_sys-resources/icon-note.png) **说明：**
>单精度浮点数的有效小数位约为 $\log_{10}(2^{24}) \approx 7.225$

## Bit
每个bit向量占用`维度 / 8 + 8`字节的存储空间。
bit的最大维度为`83,886,080`。

### 格式
```
B'0/1, ...'
```

**示例2：**
```
openGauss=# SELECT B'110';
 ?column? 
----------
 110
(1 row)
```

## Sparsevec
每个sparse向量占用`8 * 非零元素数 + 16`字节的存储空间。
每个元素都是单精度浮点数，并且所有的元素都是有限的： （不能为 `NaN`，`Infinity` 或者 `-Infinity`）。
Sparse的最大非零元素数为`16,000`，最大维度为`1,000,000,000`。

### 格式
```
{INDEX:NON-ZERO, INDEX:NON-ZERO}/<DIMENSION>::sparsevec
```
- INDEX - 非零元素下标，需小于指定维度DIMENSION
- NON-ZERO - 非零元素
- DIMENSION - 维度

**示例3：**
```
openGauss=# SELECT '{1:1.5,3:3.5}/5'::sparsevec;
    sparsevec    
-----------------
 {1:1.5,3:3.5}/5
(1 row)
```

## 维度限制
建表时若指定向量数据维度，插入数据必须等于表中的维度；如果不指定维度，则对插入的向量数据没有限制。

**示例4：**
```
# 指定维度
openGauss=# CREATE TABLE test1(val vector(3));
CREATE TABLE
openGauss=# INSERT INTO test1 (val) VALUES ('[1,2,3]');
INSERT 0 1
openGauss=# INSERT INTO test1 (val) VALUES ('[1,2,3,4]');
ERROR:  expected 3 dimensions, not 4
CONTEXT:  referenced column: val

# 不指定维度
openGauss=# CREATE TABLE test2(val vector);
CREATE TABLE
openGauss=# INSERT INTO test2 (val) VALUES ('[1,2,3]');
INSERT 0 1
openGauss=# INSERT INTO test2 (val) VALUES ('[1,2,3,4]');
INSERT 0 1
```

## 约束
- vector和sparsevec数据类型暂不支持列存表存储
- vector，bit和sparsevec暂不支持外表存储
- 支持普通行存表，临时表，Toast表，Unlogged，段页式表等的向量数据存储