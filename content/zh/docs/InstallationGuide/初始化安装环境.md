# 初始化安装环境

为了保证openGauss的正确安装，请首先对主机环境进行配置。

<!-- TOC -->

- [准备安装用户及环境](#准备安装用户及环境)
- [手工建立互信](#手工建立互信)
- [配置操作系统参数](#配置操作系统参数)

## 准备安装用户及环境

创建完openGauss配置文件后，在执行安装前，为了后续能以最小权限进行安装及openGauss管理操作，保证系统安全性，需要运行安装前置脚本gs\_preinstall准备好安装用户及环境。

安装前置脚本gs_preinstall可以协助用户自动完成如下的安装环境准备工作：

-   自动设置Linux内核参数以达到提高服务器负载能力的目的。这些参数直接影响数据库系统的运行状态，请仅在确认必要时调整。openGauss所设置的Linux内核参数取值请参见[配置操作系统参数](#配置操作系统参数)。
-   自动将openGauss配置文件、安装包拷贝到openGauss主机的相同目录下。
-   openGauss安装用户、用户组不存在时，自动创建安装用户以及用户组。
-   读取openGauss配置文件中的目录信息并创建，将目录权限授予安装用户。

### 前提条件

-   已完成[安装准备](安装准备_企业版.md)的所有任务。
-   如果是普通用户执行前置脚本gs_preinstall，需要完成[前提操作](前提操作.md)。

### 注意事项

-   用户需要检查上层目录权限，保证安装用户对安装包和配置文件目录读写执行的权限。
-   xml文件中各主机的名称与IP映射配置正确。
-   使用root或普通用户执行gs_preinstall命令。

### 操作步骤

1. 以root或普通用户登录待安装openGauss的任意主机，并按规划创建存放安装包的目录。

```
mkdir -p /opt/software/openGauss
```

>![](public_sys-resources/icon-note.png) **说明：** 
>
>-   不建议把安装包的存放目录规划到openGauss用户的根目录或其子目录下，可能导致权限问题。
>

2.将安装包“openGauss-x.x.x-openEuler-64bit-all.tar.gz”和配置文件“cluster_config.xml”都上传至上一步所创建的目录中。

3.在第一步所创建的安装包的目录下，解压安装包openGauss-x.x.x-openEuler-64bit-all.tar.gz。安装包解压后，会有OM安装包和Server安装包。继续解压OM安装包，会在/opt/software/openGauss路径下自动生成script子目录，并且在script目录下生成gs_preinstall等各种OM工具脚本。

```
cd /opt/software/openGauss
tar -zxvf openGauss-x.x.x-openEuler-64bit-all.tar.gz
tar -zxvf openGauss-x.x.x-openEuler-64bit-om.tar.gz
```

>![](public_sys-resources/icon-note.png) **说明：** 
>
>-   在执行前置脚本gs_preinstall时，需要规划好openGauss配置文件路径、安装包存放路径、程序安装目录、实例数据目录，后续普通用户使用过程中不能再更改这些路径。
>
>-   运行前置脚本gs_preinstall准备安装环境时，脚本内部会自动将openGauss配置文件、解压后的安装包同步拷贝到其余服务器的相同目录下。
>
>-   在执行前置脚本或者互信前，请检查/etc/profile文件中是否包含错误输出信息，如果存在错误输出，需手动处理。

4.修改安装包目录权限
```
chmod 755 -R /opt/software
```

>![](public_sys-resources/icon-note.png) **说明：** 
>-   openGauss用户须具有/opt/software/openGauss目录的读写权限。

5.进入到工具脚本存放目录下。

```
cd /opt/software/openGauss/script
```

6.如果是openEuler的操作系统（openEuler 20.03），执行如下命令打开performance.sh文件，用#注释sysctl -w vm.min_free_kbytes=112640 &> /dev/null，键入“ESC”键进入指令模式，执行 **:wq** 保存并退出修改。

```
vi /etc/profile.d/performance.sh
```

7.为确保成功安装，检查hostname与/etc/hostname是否一致。预安装过程中，会对hostname进行检查。

8.使用gs_preinstall准备好安装环境。若为共用环境需加入--sep-env-file=ENVFILE参数分离环境变量，避免与其他用户相互影响，ENVFILE为用户自行指定的环境变量分离文件的路径，可以为一个空文件。

- 采用交互模式执行前置，并在执行过程中自动创建操作系统root用户互信和omm用户互信：
```
./gs_preinstall -U omm -G dbgrp -X /opt/software/openGauss/cluster_config.xml
```
omm为数据库管理员（也是运行openGauss的操作系统用户），dbgrp为运行openGauss的操作系统用户的群组名称，/opt/software/openGauss/cluster_config.xml为openGauss配置文件路径。在执行过程中，用户根据提示选择是否创建互信，并输入操作系统root用户或omm用户的密码。

- 允许创建root用户互信时，预安装脚本在执行的时候会将各个主机的ip,hostname写入到/etc/hosts中，并在每个映射关系后边加入注释内容：#Gauss OM IP Hosts Mapping。
- 不允许创建root用户互信时，此时需要用户手动先建立互信（也就是将各个主机的ip，hostname写入到/etc/hosts中），然后执行预安装脚本
  
    a.执行下面命令准备安装环境。

    ```
    cd /opt/software/openGauss/script
    ./gs_preinstall -U omm -G dbgrp -L -X /opt/software/openGauss/cluster_config.xml
    ```

    >![](public_sys-resources/icon-note.png) **说明：** 
    >此操作需要在每台主机上执行该命令。
    >
    
    - 采用非交互模式执行前置：
    
    a.参考[手工建立互信](#手工建立互信)章节手工建立root用户互信和openGauss用户互信。
    
    b.执行下面命令准备安装环境。

    ```
    cd /opt/software/openGauss/script
    ./gs_preinstall -U omm -G dbgrp -X /opt/software/openGauss/cluster_config.xml --non-interactive
    ```
    
    >![](public_sys-resources/icon-note.png) **说明：** 
    >
    >-   此模式要求用户确保在执行前，已经建立了各节点root用户互信和openGauss用户互信。 
    >
    >-   root用户互信可能会存在安全隐患，因此建议用户在执行完安装后，立即删除各主机上root用户的互信。  




### 示例

执行前置脚本：

```
plat1:/opt/software/openGauss/script # ./gs_preinstall -U omm -G dbgrp -X /opt/software/openGauss/cluster_config.xml
Parsing the configuration file.
Successfully parsed the configuration file.
Installing the tools on the local node.
Successfully installed the tools on the local node.
Are you sure you want to create trust for root (yes/no)? yes
Please enter password for root.
Password:
Creating SSH trust for the root permission user.
Setting host ip env
Successfully set host ip env.
Distributing package.
Begin to distribute package to tool path.
Successfully distribute package to tool path.
Begin to distribute package to package path.
Successfully distribute package to package path.
Successfully distributed package.
Are you sure you want to create the user[omm] and create trust for it (yes/no)? yes
Please enter password for cluster user.
Password: 
Generate cluster user password files successfully.
Successfully created [omm] user on all nodes.
Preparing SSH service.
Successfully prepared SSH service.
Installing the tools in the cluster.
Successfully installed the tools in the cluster.
Checking hostname mapping.
Successfully checked hostname mapping.
Creating SSH trust for [omm] user.
Please enter password for current user[omm].
Password: 
Checking network information.
All nodes in the network are Normal.
Successfully checked network information.
Creating SSH trust.
Creating the local key file.
Successfully created the local key files.
Appending local ID to authorized_keys.
Successfully appended local ID to authorized_keys.
Updating the known_hosts file.
Successfully updated the known_hosts file.
Appending authorized_key on the remote node.
Successfully appended authorized_key on all remote node.
Checking common authentication file content.
Successfully checked common authentication content.
Distributing SSH trust file to all node.
Successfully distributed SSH trust file to all node.
Verifying SSH trust on all hosts.
Successfully verified SSH trust on all hosts.
Successfully created SSH trust.
Successfully created SSH trust for the root permission user.
Setting pssh path
Successfully set core path.
Distributing package.
Begin to distribute package to tool path.
Successfully distribute package to tool path.
Begin to distribute package to package path.
Successfully distribute package to package path.
Successfully distributed package.
Are you sure you want to create the user[omm] and create trust for it (yes/no)? yes
Please enter password for cluster user.
Password:
Please enter password for cluster user again.
Password:
Successfully created [omm] user on all nodes.
Preparing SSH service.
Successfully prepared SSH service.
Installing the tools in the cluster.
Successfully installed the tools in the cluster.
Checking hostname mapping.
Successfully checked hostname mapping.
Creating SSH trust for [omm] user.
Checking network information.
All nodes in the network are Normal.
Successfully checked network information.
Creating SSH trust.
Creating the local key file.
Successfully created the local key files.
Appending local ID to authorized_keys.
Successfully appended local ID to authorized_keys.
Updating the known_hosts file.
Successfully updated the known_hosts file.
Appending authorized_key on the remote node.
Successfully appended authorized_key on all remote node.
Checking common authentication file content.
Successfully checked common authentication content.
Distributing SSH trust file to all node.
Successfully distributed SSH trust file to all node.
Verifying SSH trust on all hosts.
Successfully verified SSH trust on all hosts.
Successfully created SSH trust.
Successfully created SSH trust for [omm] user.
Checking OS software.
Successfully check os software.
Checking OS version.
Successfully checked OS version.
Creating cluster's path.
Successfully created cluster's path.
Set and check OS parameter.
Setting OS parameters.
Successfully set OS parameters.
Preparing CRON service.
Successfully prepared CRON service.
Setting user environmental variables.
Successfully set user environmental variables.
Setting the dynamic link library.
Successfully set the dynamic link library.
Setting Core file
Successfully set core path.
Setting pssh path
Successfully set pssh path.
Set ARM Optimization.
No need to set ARM Optimization.
Fixing server package owner.
Setting finish flag.
Successfully set finish flag.
PreInstallationGuide succeeded.
```

如果主备机的root用户密码不同，且不能统一修改为一致时，执行前置脚本本地安装模式：

```
plat1:/opt/software/openGauss/script # ./gs_preinstall -U omm -G dbgrp -L -X /opt/software/openGauss/cluster_config.xml 
Parsing the configuration file.
Successfully parsed the configuration file.
Installing the tools on the local node.
Successfully installed the tools on the local node.
Checking OS version.
Successfully checked OS version.
Creating cluster's path.
Successfully created cluster's path.
Set and check OS parameter.
Setting OS parameters.
Successfully set OS parameters.
Warning: InstallationGuide environment contains some warning messages.
Please get more details by "/home/package/r8c00/script/gs_checkos -i A -h SIA1000068990".
Set and check OS parameter completed.
Preparing CRON service.
Successfully prepared CRON service.
Preparing SSH service.
Successfully prepared SSH service.
Setting user environmental variables.
Successfully set user environmental variables.
Configuring alarms on the cluster nodes.
Successfully configured alarms on the cluster nodes.
Setting the dynamic link library.
Successfully set the dynamic link library.
Setting Cgroup.
Successfully set Cgroup.
Setting finish flag.
Successfully set finish flag.
PreInstallationGuide succeeded.
```

以非交互模式执行前置：

```
plat1:/opt/software/openGauss/script # ./gs_preinstall -U omm -G dbgrp -X /opt/software/openGauss/cluster_config.xml --non-interactive
Parsing the configuration file.
Successfully parsed the configuration file.
Installing the tools on the local node.
Successfully installed the tools on the local node.
Distributing package.
Begin to distribute package to tool path.
Successfully distribute package to tool path.
Begin to distribute package to package path.
Successfully distribute package to package path.
Successfully distributed package.
Installing the tools in the cluster.
Successfully installed the tools in the cluster.
Checking hostname mapping.
Successfully checked hostname mapping.
Checking OS version.
Successfully checked OS version.
Creating cluster's path.
Successfully created cluster's path.
Set and check OS parameter.
Setting OS parameters.
Successfully set OS parameters.
Set and check OS parameter completed.
Preparing CRON service.
Successfully prepared CRON service.
Preparing SSH service.
Successfully prepared SSH service.
Setting user environmental variables.
Successfully set user environmental variables.
Configuring alarms on the cluster nodes.
Successfully configured alarms on the cluster nodes.
Setting the dynamic link library.
Successfully set the dynamic link library.
Setting Cgroup.
Successfully set Cgroup.
Set ARM Optimization.
Successfully set ARM Optimization.
Setting finish flag.
Successfully set finish flag.
PreInstallationGuide succeeded.
```

### 错误排查

如果准备安装环境失败请根据openGauss日志目录“$GAUSSLOG/om”下的“gs_preinstall-YYYY-MM-DD_HHMMSS.log”和“gs_local-YYYY-MM-DD_HHMMSS.log”中的日志信息排查错误。例如配置文件中“gaussdbLogPath”参数指定的路径为“/var/log/gaussdb”，则“$GAUSSLOG/om”路径为“/var/log/gaussdb/omm/om”，omm用户为运行openGauss的用户。

![](public_sys-resources/icon-notice.png) **须知：** 

准备安装用户及环境的过程中会使用root添加定时任务用于定时巡检和上报。

## 手工建立互信

openGauss在安装过程中，需要在openGauss中的主机间执行命令、传送文件等操作。因此，在普通用户安装前需要确保互信是连通的。前置脚本中会先建立root用户间的互信，然后创建普通用户，并建立普通用户间的互信。

![](public_sys-resources/icon-notice.png) **须知：**

root用户互信可能会存在安全隐患，因此建议用户在使用完成后，立即删除各主机上root用户的互信。

### 前提条件

-   确保ssh服务打开。
-   确保ssh端口不会被防火墙关闭。
-   确保xml文件中各主机名称和IP配置正确。
-   确保所有机器节点间网络畅通。
-   如果为普通用户建立互信，需要提前在各主机创建相同用户并设置密码。
-   如果各主机安装并启动了SELinux服务，需要确保/root和/home目录安全上下文为默认值（home目录：system_u:object_r:home_root_t:s0，root目录：system_u:object_r:admin_home_t:s0）或者关闭掉SELinux服务。

    检查系统SELinux状态的方法：执行命令getenforce，如果返回结果是Enforcing，说明SELinux安装并启用。

    检查目录安全上下文的命令：

    ```
    ls -ldZ  /root | awk '{print $4}'
    ```

    ```
    ls -ldZ  /home | awk '{print $4}'
    ```

    恢复目录安全上下文命令：

    ```
    restorecon -r -vv /home/
    ```

    ```
    restorecon -r -vv /root/
    ```


### 使用脚本建立互信

1.创建一个执行互信脚本所需要的输入文本，并在此文件中添加openGauss中所有主机IP。

```
plat1:/opt/software/openGauss> vim hostfile
192.168.0.1
192.168.0.2
192.168.0.3
```

2.以需要创建互信的用户执行脚本。
3.执行下面脚本建立互信。

```
plat1:/opt/software/openGauss/script# ./gs_sshexkey -f /opt/software/hostfile
```

/opt/software/hostfile为主机列表，列出所有需要建立互信机器的主机IP。


### 手工建立互信

如果openGauss各主机的root密码不一致，gs_preinstall脚本无法建立互信，可以手工建立互信。

>![](public_sys-resources/icon-note.png) **说明：** 
>
>建立互信的过程中需要生成如下4个文件：authorized_keys、id_rsa、id_rsa.pub、known_hosts。请勿删除或破坏这些互信相关的文件。
>
手工建立信任关系，步骤如下，plat1、plat2、plat3是主机名：

1.在其中一个主机上，生成root用户的本机授权文件。假设在主机plat1上执行。

 a. 生成密钥。
```
ssh-keygen -t rsa
```
示例如下：

```
plat1:~ # ssh-keygen -t rsa 
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): 
Created directory '/root/.ssh'.
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
d5:35:46:33:27:22:09:f0:1e:12:a7:87:fa:33:3f:ab root@plat1
The key's randomart image is:
+--[ RSA 2048]----+
|      o.o.....O .|
|       *  .o + * |
|      + + . .    |
|     . + o       |
|    .   S        |
|     .           |
|      +          |
|       +.        |
|      E.oo       |
+-----------------+
```

 b. 生成本机授权文件。
```
cat .ssh/id_rsa.pub >> ~/.ssh/authorized_keys
```
示例如下：
```
plat1:~ # cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
```

2.收集所有的待建互信主机的公钥，写入到本机的known_hosts文件中。此步骤需要在步骤1执行的主机上执行。需要收集plat1、plat2、plat3三个主机的公钥。

 a. 收集plat1的公钥，写入到本机known_hosts文件中。
```
ssh-keyscan -t rsa plat1 >> ~/.ssh/known_hosts
```
示例如下：
```
plat1:~ # ssh-keyscan -t rsa plat1 >> ~/.ssh/known_hosts 
# plat1 SSH-2.0-OpenSSH_5.1 
```
 b. 收集plat2的公钥，写入到本机known_hosts文件中。
```
ssh-keyscan -t rsa plat2 >> ~/.ssh/known_hosts
```
示例如下：
```
plat1:~ # ssh-keyscan -t rsa plat2 >> ~/.ssh/known_hosts 
# plat2 SSH-2.0-OpenSSH_5.1 
```
 c. 收集plat3的公钥，写入到本机known_hosts文件中。
```
ssh-keyscan -t rsa plat3 >> ~/.ssh/known_hosts
```
示例如下：
```
plat1:~ # ssh-keyscan -t rsa plat3 >> ~/.ssh/known_hosts 
# plat3 SSH-2.0-OpenSSH_5.1 
```
>![](public_sys-resources/icon-note.png) **说明：** 
>
>-   当远程主机的公钥被接受以后，它就会被保存在文件$HOME/.ssh/known_hosts之中。下次再连接这台主机，系统就会认出它的公钥已经保存在本地了，从而跳过警告部分。
>
>-   如果该主机上known_hosts文件被删除，互信仍然可以使用，但是会有告警提示信息。如果需要规避告警提示信息，请将/etc/ssh/ssh_config配置文件中，StrictHostKeyChecking参数设置为no。
>
>-   root和omm用户都需要建立互信。 omm下除了使用节点名称建立互信外，还需要建立节点ip之间的互信。操作步骤同上，将节点名称替换为节点ip执行。   

3.将互信文件分发到其它所有主机上。在本例中，需要将plat1上的互信文件分发到plat2和plat3上。

 a. 将互信文件分发到plat2上。Password输入拷贝目标主机的密码。
```
scp -r ~/.ssh plat2:~
```
示例如下：
```
plat1:~ # scp -r ~/.ssh plat2:~
Password: 
authorized_keys                 100%  796     0.8KB/s   00:00    
id_rsa                          100% 1675     1.6KB/s   00:00    
id_rsa.pub                      100%  398     0.4KB/s   00:00    
known_hosts                     100% 1089     1.1KB/s   00:00    
```
 b. 将互信文件分发到plat3上。Password输入拷贝目标主机的密码。
```
scp -r ~/.ssh plat3:~
```
示例如下：
```
plat1:~ # scp -r ~/.ssh plat3:~
Password: 
authorized_keys                 100%  796     0.8KB/s   00:00    
id_rsa                          100% 1675     1.6KB/s   00:00    
id_rsa.pub                      100%  398     0.4KB/s   00:00    
known_hosts                     100% 1089     1.1KB/s   00:00    
```

4.查看互信是否建成功，可以互相ssh主机名。输入exit退出。

```
plat1:~ # ssh plat2
Last login: Sat Jun 20 14:01:07 2020
plat2:~ # exit
logout
Connection to plat2 closed.
plat1:~ # 
```

>![](public_sys-resources/icon-note.png) **说明：** 
>
>如果openGauss集群包含三个以上服务器节点，操作过程和上述步骤类似。假设节点名为plat1、plat2、plat3、......。第一步，需要在plat1上生成root用户的本机授权文件；第二步，需要收集所有待建互信主机(plat1、plat2、plat3、......)的公钥并写入到本机known_hosts文件中；第三步，需要将互信文件分发到除本机外的所有其它主机(plat2、plat3、......)上；第四步，检查互信是否建立成功。
>

### 删除root用户互信

为了避免root用户互信可能存在的安全隐患，因此建议用户在使用完成后，立即删除各主机上root用户的互信。

1.删除openGauss数据库各节点上的互信相关文件/root/.ssh。

```
rm –rf ~/.ssh
```

2.查看互信是否删除成功，可以互相ssh主机名，提示不能互信，互信删除成功。

```
plat1:\~ \# ssh plat2

he authenticity of host ' plssat2 \(plat2\)' can't be established.

ECDSA key fingerprint is SHA256:Q4DPRedFytsjsJSKf4l2lHKuzVw4prq3bIUCNVKIa7M.

ECDSA key fingerprint is MD5:e2:77:6c:aa:4c:43:5f:f2:c4:58:ec:d5:53:de:7c:fc.

Are you sure you want to continue connecting \(yes/no\)?
```




### 示例

root用户建立互信示例：

```
plat1:~ # gs_sshexkey -f /opt/software/hostfile -W Gauss_123
Checking network information.
All nodes in the network are Normal.
Successfully checked network information.
Creating SSH trust.
Creating the local key file.
Successfully created the local key files.
Appending local ID to authorized_keys.
Successfully appended local ID to authorized_keys.
Updating the known_hosts file.
Successfully updated the known_hosts file.
Appending authorized_key on the remote node.
Successfully appended authorized_key on all remote node.
Checking common authentication file content.
Successfully checked common authentication content.
Distributing SSH trust file to all node.
Successfully distributed SSH trust file to all node.
Verifying SSH trust on all hosts.
Successfully verified SSH trust on all hosts.
Successfully created SSH trust.
```

普通用户建立互信示例：

```
gaussdb@plat1:~ > gs_sshexkey -f /opt/software/hostfile -W Gauss_123
Checking network information.
All nodes in the network are Normal.
Successfully checked network information.
Creating SSH trust.
Creating the local key file.
Successfully created the local key files.
Appending local ID to authorized_keys.
Successfully appended local ID to authorized_keys.
Updating the known_hosts file.
Successfully updated the known_hosts file.
Appending authorized_key on the remote node.
Successfully appended authorized_key on all remote node.
Checking common authentication file content.
Successfully checked common authentication content.
Distributing SSH trust file to all node.
Successfully distributed SSH trust file to all node.
Verifying SSH trust on all hosts.
Successfully verified SSH trust on all hosts.
Successfully created SSH trust.
```

安全模式下建立互信示例，需要用户根据提示，手动输入建立互信的用户密码（建议使用安全模式）：

```
plat1:~ # gs_sshexkey -f /opt/software/hostfile
Please enter password for current user[root].
Password: 
Checking network information.
All nodes in the network are Normal.
Successfully checked network information.
Creating SSH trust.
Creating the local key file.
Appending local ID to authorized_keys.
Successfully appended local ID to authorized_keys.
Updating the known_hosts file.
Successfully updated the known_hosts file.
Appending authorized_key on the remote node.
Successfully appended authorized_key on all remote node.
Checking common authentication file content.
Successfully checked common authentication content.
Distributing SSH trust file to all node.
Successfully distributed SSH trust file to all node.
Verifying SSH trust on all hosts.
Successfully verified SSH trust on all hosts.
Successfully created SSH trust.
```

## 配置操作系统参数

openGauss要求各主机上的操作系统参数设置成一定的值，以满足系统运行的性能要求等。

这些参数有些会在openGauss安装环境准备阶段完成设置，且这些参数将直接影响openGauss的运行状态，请仅在确认必要时进行手动调整。方法如下：

1.以root用户身份登录服务器。

2.对文件“/etc/sysctl.conf”进行编辑修改。

具体参数的修改请参见[操作系统参数](#操作系统参数)。

3.执行如下命令使修改配置生效。

```
sysctl -p
```


### 操作系统参数

**表 1**  操作系统参数

<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_table174711620568"></a>
<table><thead align="left"><tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row134711465560"><th class="cellrowborder" valign="top" width="22.270000000000003%" id="mcps1.2.5.1.1"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p258931915710"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p258931915710"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p258931915710"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="48.13000000000001%" id="mcps1.2.5.1.2"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1358931917574"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1358931917574"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1358931917574"></a>参数说明</p>
</th>
<th class="cellrowborder" valign="top" width="15.760000000000002%" id="mcps1.2.5.1.3"><p id="p1690011152212"><a name="p1690011152212"></a><a name="p1690011152212"></a>预安装时是否由脚本自动设置</p>
</th>
<th class="cellrowborder" valign="top" width="13.840000000000002%" id="mcps1.2.5.1.4"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6590119125718"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6590119125718"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6590119125718"></a>推荐取值</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row647214625611"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1125722695711"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1125722695711"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1125722695711"></a>net.ipv4.tcp_max_tw_buckets</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p182571426125710"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p182571426125710"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p182571426125710"></a>表示同时保持TIME_WAIT状态的TCP/IP连接最大数量。如果超过所配置的取值，TIME_WAIT将立刻被释放并打印警告信息。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p119011915422"><a name="p119011915422"></a><a name="p119011915422"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p42571268571"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p42571268571"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p42571268571"></a>10000</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row4472364569"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p59261713115813"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p59261713115813"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p59261713115813"></a>net.ipv4.tcp_tw_reuse</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p169261713135818"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p169261713135818"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p169261713135818"></a>允许将TIME-WAIT状态的sockets重新用于新的TCP连接。</p>
<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul99261213185819"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul99261213185819"></a><ul id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul99261213185819"><li>0表示关闭。</li><li>1表示开启。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p209015151214"><a name="p209015151214"></a><a name="p209015151214"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1692713134587"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1692713134587"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1692713134587"></a>1</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row94736616569"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p292717139588"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p292717139588"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p292717139588"></a>net.ipv4.tcp_tw_recycle</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1992811310580"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1992811310580"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1992811310580"></a>表示开启TCP连接中TIME-WAIT状态sockets的快速回收。</p>
<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul17928101395817"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul17928101395817"></a><ul id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul17928101395817"><li>0表示关闭。</li><li>1表示开启。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p1590112151228"><a name="p1590112151228"></a><a name="p1590112151228"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1928613155814"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1928613155814"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1928613155814"></a>1</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row4676171295719"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p11929181313586"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p11929181313586"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p11929181313586"></a>net.ipv4.tcp_keepalive_time</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p199291139588"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p199291139588"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p199291139588"></a>表示当keepalive启用的时候，TCP发送keepalive消息的频度。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p590118151725"><a name="p590118151725"></a><a name="p590118151725"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p892911355817"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p892911355817"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p892911355817"></a>30</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row17677191218575"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1492941395814"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1492941395814"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1492941395814"></a>net.ipv4.tcp_keepalive_probes</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p49291138584"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p49291138584"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p49291138584"></a>在认定连接失效之前，发送TCP的keepalive探测包数量。这个值乘以tcp_keepalive_intvl之后决定了一个连接发送了keepalive之后可以有多少时间没有回应。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p159017154213"><a name="p159017154213"></a><a name="p159017154213"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p5930181310585"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p5930181310585"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p5930181310585"></a>9</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row1467720124571"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1593010138588"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1593010138588"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1593010138588"></a>net.ipv4.tcp_keepalive_intvl</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p59301313185815"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p59301313185815"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p59301313185815"></a>当探测没有确认时，重新发送探测的频度。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p129011215625"><a name="p129011215625"></a><a name="p129011215625"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p4931151314582"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p4931151314582"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p4931151314582"></a>30</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row885193417577"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p209310131583"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p209310131583"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p209310131583"></a>net.ipv4.tcp_retries1</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6932131313581"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6932131313581"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6932131313581"></a>在连接建立过程中TCP协议最大重试次数。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p169021158217"><a name="p169021158217"></a><a name="p169021158217"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p793281355810"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p793281355810"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p793281355810"></a>5</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row785253455720"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17932713145816"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17932713145816"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17932713145816"></a>net.ipv4.tcp_syn_retries</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p189321613175819"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p189321613175819"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p189321613175819"></a>TCP协议SYN报文最大重试次数。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p2090231516211"><a name="p2090231516211"></a><a name="p2090231516211"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p693313136582"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p693313136582"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p693313136582"></a>5</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row10853153425712"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1293371305814"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1293371305814"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1293371305814"></a>net.ipv4.tcp_synack_retries</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17933201318587"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17933201318587"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17933201318587"></a>TCP协议SYN应答报文最大重试次数。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p1690216151723"><a name="p1690216151723"></a><a name="p1690216151723"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p99331013155811"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p99331013155811"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p99331013155811"></a>5</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row0188144110571"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p203091939195813"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p203091939195813"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p203091939195813"></a>net.ipv4.tcp_retries2</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1331013399587"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1331013399587"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1331013399587"></a>控制内核向已经建立连接的远程主机重新发送数据的次数，低值可以更早的检测到与远程主机失效的连接，因此服务器可以更快的释放该连接。</p>
<p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p133103392585"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p133103392585"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p133103392585"></a>发生“connection reset by peer”时可以尝试调大该值规避问题。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p1290291518214"><a name="p1290291518214"></a><a name="p1290291518214"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p83101739145811"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p83101739145811"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p83101739145811"></a>12</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row0188184135716"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p10310183915815"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p10310183915815"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p10310183915815"></a>vm.overcommit_memory</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12311173912584"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12311173912584"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12311173912584"></a>控制在做内存分配的时候，内核的检查方式。</p>
<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul14311183913587"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul14311183913587"></a><ul id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul14311183913587"><li>0：表示系统会尽量精确计算当前可用的内存。</li><li>1：表示不作检查直接返回成功。</li><li>2：内存总量×vm.overcommit_ratio/100＋SWAP的总量，如果申请空间超过此数值则返回失败。</li></ul>
<p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p193123394589"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p193123394589"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p193123394589"></a>内核默认是2过于保守，推荐设置为0，如果系统压力大可以设置为1。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p490291520219"><a name="p490291520219"></a><a name="p490291520219"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13313153945816"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13313153945816"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13313153945816"></a>0</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row3361592574"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p19529155145913"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p19529155145913"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p19529155145913"></a>net.ipv4.tcp_rmem</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1452915511595"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1452915511595"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1452915511595"></a>TCP协议接收端缓冲区的可用内存大小。分无压力、有压力和压力大三个区间，单位为页面。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p190314151126"><a name="p190314151126"></a><a name="p190314151126"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p5529155105915"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p5529155105915"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p5529155105915"></a>8192 250000 16777216</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row10378590579"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p953010511591"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p953010511591"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p953010511591"></a>net.ipv4.tcp_wmem</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1153017545918"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1153017545918"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1153017545918"></a>TCP协议发送端缓冲区的可用内存大小。分无压力、有压力和压力大三个区间，单位为页面。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p1990411152028"><a name="p1990411152028"></a><a name="p1990411152028"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p195301356597"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p195301356597"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p195301356597"></a>8192 250000 16777216</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row2387595578"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163351922125910"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163351922125910"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163351922125910"></a>net.core.wmem_max</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p14335132214593"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p14335132214593"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p14335132214593"></a>socket发送端缓冲区大小的最大值。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p199040151025"><a name="p199040151025"></a><a name="p199040151025"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p633582217598"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p633582217598"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p633582217598"></a>21299200</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row33995910574"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12336132225915"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12336132225915"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12336132225915"></a>net.core.rmem_max</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p2336172218596"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p2336172218596"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p2336172218596"></a>socket接收端缓冲区大小的最大值。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p490419159212"><a name="p490419159212"></a><a name="p490419159212"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163361222205919"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163361222205919"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163361222205919"></a>21299200</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row1739559195711"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8336142211595"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8336142211595"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8336142211595"></a>net.core.wmem_default</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6337182218592"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6337182218592"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p6337182218592"></a>socket发送端缓冲区大小的默认值。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p149048151427"><a name="p149048151427"></a><a name="p149048151427"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p193371222105920"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p193371222105920"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p193371222105920"></a>21299200</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row14011595570"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p333715223593"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p333715223593"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p333715223593"></a>net.core.rmem_default</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163371922175915"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163371922175915"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163371922175915"></a>socket接收端缓冲区大小的默认值。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p49041215428"><a name="p49041215428"></a><a name="p49041215428"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13338122275917"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13338122275917"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13338122275917"></a>21299200</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row1041959195714"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1833892275911"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1833892275911"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1833892275911"></a>net.ipv4.ip_local_port_range</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p0338112235914"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p0338112235914"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p0338112235914"></a>物理机可用临时端口范围。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p890411151129"><a name="p890411151129"></a><a name="p890411151129"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p14339142235915"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p14339142235915"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p14339142235915"></a>26000-65535</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row0425596573"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1933992225914"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1933992225914"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1933992225914"></a>kernel.sem</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p933942215595"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p933942215595"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p933942215595"></a>内核信号量参数设置大小。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p490411151822"><a name="p490411151822"></a><a name="p490411151822"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12340132213597"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12340132213597"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12340132213597"></a>250 6400000 1000 25600</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row44385915579"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p934010229591"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p934010229591"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p934010229591"></a>vm.min_free_kbytes</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p183405228591"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p183405228591"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p183405228591"></a>保证物理内存有足够空闲空间，防止突发性换页。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p890517151123"><a name="p890517151123"></a><a name="p890517151123"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17341142215591"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17341142215591"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17341142215591"></a>系统总内存的5%</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row9431359105719"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p11341322145910"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p11341322145910"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p11341322145910"></a>net.core.somaxconn</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1234282213599"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1234282213599"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1234282213599"></a>定义了系统中每一个端口最大的监听队列的长度，这是个全局的参数。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p1290515157211"><a name="p1290515157211"></a><a name="p1290515157211"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p534272295916"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p534272295916"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p534272295916"></a>65535</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row11442059175716"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163421022125917"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163421022125917"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p163421022125917"></a>net.ipv4.tcp_syncookies</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1534362218593"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1534362218593"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1534362218593"></a>当出现SYN等待队列溢出时，启用cookies来处理，可防范少量SYN攻击。</p>
<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul534318226591"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul534318226591"></a><ul id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul534318226591"><li>0表示关闭SYN Cookies。</li><li>1表示开启SYN Cookies。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p9905121512214"><a name="p9905121512214"></a><a name="p9905121512214"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p133441022135919"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p133441022135919"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p133441022135919"></a>1</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row119054135715"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1671381607"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1671381607"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1671381607"></a>net.core.netdev_max_backlog</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1975811012"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1975811012"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1975811012"></a>在每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p159054151527"><a name="p159054151527"></a><a name="p159054151527"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1287819014"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1287819014"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1287819014"></a>65535</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row1319012411575"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p19813814012"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p19813814012"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p19813814012"></a>net.ipv4.tcp_max_syn_backlog</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13818816015"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13818816015"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p13818816015"></a>记录的那些尚未收到客户端确认信息的连接请求的最大值。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p12905215225"><a name="p12905215225"></a><a name="p12905215225"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1791986010"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1791986010"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1791986010"></a>65535</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row111911441145720"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p20914818010"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p20914818010"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p20914818010"></a>net.ipv4.tcp_fin_timeout</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p7978801"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p7978801"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p7978801"></a>系统默认的超时时间。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p19905815127"><a name="p19905815127"></a><a name="p19905815127"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17101281003"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17101281003"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17101281003"></a>60</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row171915417579"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p61016819012"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p61016819012"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p61016819012"></a>kernel.shmall</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1810481505"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1810481505"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1810481505"></a>内核可用的共享内存总量。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p29055154219"><a name="p29055154219"></a><a name="p29055154219"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8101081004"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8101081004"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8101081004"></a>1152921504606846720</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row1093874517594"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p4118812012"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p4118812012"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p4118812012"></a>kernel.shmmax</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p131117813014"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p131117813014"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p131117813014"></a>内核参数定义单个共享内存段的最大值。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p1290511151825"><a name="p1290511151825"></a><a name="p1290511151825"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p181188803"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p181188803"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p181188803"></a>18446744073709551615</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row1493934585918"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p412986019"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p412986019"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p412986019"></a>net.ipv4.tcp_sack</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p112881904"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p112881904"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p112881904"></a>启用有选择的应答，通过有选择地应答乱序接受到的报文来提高性能，让发送者只发送丢失的报文段（对于广域网来说）这个选项应该启用，但是会增加对CPU的占用。</p>
<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul112208308"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul112208308"></a><ul id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul112208308"><li>0表示关闭。</li><li>1表示开启。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p49061115326"><a name="p49061115326"></a><a name="p49061115326"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17131181208"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17131181208"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p17131181208"></a>1</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row199407451592"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p111418818011"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p111418818011"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p111418818011"></a>net.ipv4.tcp_timestamps</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p10141681903"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p10141681903"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p10141681903"></a>TCP时间戳（会在TCP包头增加12节），以一种比重发超时更精确的方式（参考RFC 1323）来启用对RTT的计算，启用可以实现更好的性能。</p>
<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul814881508"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul814881508"></a><ul id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_ul814881508"><li>0表示关闭。</li><li>1表示开启。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p790651519211"><a name="p790651519211"></a><a name="p790651519211"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p18151381901"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p18151381901"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p18151381901"></a>1</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row3940154515911"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p02308185016"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p02308185016"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p02308185016"></a>vm.extfrag_threshold</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p62301518909"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p62301518909"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p62301518909"></a>系统内存不够用时，linux会为当前系统内存碎片情况打分，如果超过vm.extfrag_threshold的值，kswapd就会触发memory compaction。所以这个值设置的接近1000，说明系统在内存碎片的处理倾向于把旧的页换出，以符合申请的需要，而设置接近0，表示系统在内存碎片的处理倾向做memory compaction。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p49065155212"><a name="p49065155212"></a><a name="p49065155212"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p923111816015"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p923111816015"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p923111816015"></a>500</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row14114125155912"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8231218904"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8231218904"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p8231218904"></a>vm.overcommit_ratio</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1823117183015"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1823117183015"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p1823117183015"></a>系统使用绝不过量分配内存的算法时，系统整个内存地址空间不得超过swap+RAM值的此参数百分比，当vm.overcommit_memory=2时此参数生效。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p2090613159212"><a name="p2090613159212"></a><a name="p2090613159212"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12232121819017"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12232121819017"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p12232121819017"></a>90</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_row151152051125910"><td class="cellrowborder" valign="top" width="22.270000000000003%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p2233161813015"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p2233161813015"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p2233161813015"></a>MTU</p>
</td>
<td class="cellrowborder" valign="top" width="48.13000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p32330181404"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p32330181404"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p32330181404"></a>节点网卡最大传输单元。OS默认值为1500，调整为8192可以提升数据收发的性能。</p>
</td>
<td class="cellrowborder" valign="top" width="15.760000000000002%" headers="mcps1.2.5.1.3 "><p id="p19906171511217"><a name="p19906171511217"></a><a name="p19906171511217"></a>否</p>
</td>
<td class="cellrowborder" valign="top" width="13.840000000000002%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p223412181010"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p223412181010"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0085031791_p223412181010"></a>8192</p>
</td>
</tr>
</tbody>
</table>



### 文件系统参数

-   soft nofile

    说明：soft nofile表示软限制，用户使用的文件句柄数量可以超过该限制，但是如果超过会有告警信息。

    推荐取值：1000000

-   hard nofile

    说明：hard nofile表示硬限制，是一个严格的限制，用户使用的文件句柄数量一定不能超过该设置。

    推荐取值：1000000

-   stack size

    说明：线程堆栈大小。

    推荐值：3072


### transparent\_hugepage设置

openGauss默认关闭使用transparent\_hugepage服务，并将关闭命令写入操作系统启动文件。

### 文件句柄设置

需要对文件句柄数进行手动设置时，使用root用户执行如下命令进行参数修改：

```
echo "* soft nofile 1000000" >>/etc/security/limits.conf
echo "* hard nofile 1000000" >>/etc/security/limits.conf
```

完成修改后，需重启操作系统使得设置的参数生效。

**表 2**  文件句柄数设置

<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_table66928349154930"></a>
<table><thead align="left"><tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_row32458049154930"><th class="cellrowborder" valign="top" width="17.47%" id="mcps1.2.5.1.1"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p29726478135851"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p29726478135851"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p29726478135851"></a>参数名</p>
</th>
<th class="cellrowborder" valign="top" width="52.07000000000001%" id="mcps1.2.5.1.2"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6791871135943"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6791871135943"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6791871135943"></a>说明</p>
</th>
<th class="cellrowborder" valign="top" width="21.060000000000002%" id="mcps1.2.5.1.3"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p17069230135851"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p17069230135851"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p17069230135851"></a>预安装时是否由脚本自动设置</p>
</th>
<th class="cellrowborder" valign="top" width="9.4%" id="mcps1.2.5.1.4"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p45338003135924"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p45338003135924"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p45338003135924"></a>推荐取值</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_row36414898154930"><td class="cellrowborder" valign="top" width="17.47%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p53634223135851"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p53634223135851"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p53634223135851"></a>* soft nofile</p>
</td>
<td class="cellrowborder" valign="top" width="52.07000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1184561135943"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1184561135943"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1184561135943"></a>soft nofile表示软限制，即表示任何用户能打开的最大文件数量为1000000，不管它开启多少个shell。</p>
</td>
<td class="cellrowborder" valign="top" width="21.060000000000002%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p42366546135851"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p42366546135851"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p42366546135851"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="9.4%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p36154703135924"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p36154703135924"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p36154703135924"></a>1000000</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_row3006053154930"><td class="cellrowborder" valign="top" width="17.47%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p15135199135851"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p15135199135851"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p15135199135851"></a>* hard nofile</p>
</td>
<td class="cellrowborder" valign="top" width="52.07000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p58238613135943"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p58238613135943"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p58238613135943"></a>hard nofile表示硬限制，软限制要小于等于硬限制。</p>
</td>
<td class="cellrowborder" valign="top" width="21.060000000000002%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p48031615135851"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p48031615135851"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p48031615135851"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="9.4%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p50103914135924"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p50103914135924"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p50103914135924"></a>1000000</p>
</td>
</tr>
</tbody>
</table>

### 系统支持的最大进程数设置

需要对系统支持的最大进程数进行手动设置时，执行如下命令打开conf文件。

```
vim /etc/security/limits.d/90-nproc.conf
```

修改\* soft nproc参数。

完成修改后，需重启操作系统使得设置的参数生效。

**表 3**  系统支持的最大进程数设置

<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_table51875363151525"></a>
<table><thead align="left"><tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_row23677630151525"><th class="cellrowborder" valign="top" width="17.47%" id="mcps1.2.5.1.1"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p38839882151525"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p38839882151525"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p38839882151525"></a>参数名</p>
</th>
<th class="cellrowborder" valign="top" width="52.07000000000001%" id="mcps1.2.5.1.2"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p59022734151525"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p59022734151525"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p59022734151525"></a>说明</p>
</th>
<th class="cellrowborder" valign="top" width="21.060000000000002%" id="mcps1.2.5.1.3"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p16112179151525"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p16112179151525"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p16112179151525"></a>预安装时是否由脚本自动设置</p>
</th>
<th class="cellrowborder" valign="top" width="9.4%" id="mcps1.2.5.1.4"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p30018145151525"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p30018145151525"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p30018145151525"></a>推荐取值</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_row15550655151525"><td class="cellrowborder" valign="top" width="17.47%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p51643509151525"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p51643509151525"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p51643509151525"></a>* soft nproc</p>
</td>
<td class="cellrowborder" valign="top" width="52.07000000000001%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p22374700151525"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p22374700151525"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p22374700151525"></a>soft nproc参数用来限制每个用户的最大processes数量。</p>
</td>
<td class="cellrowborder" valign="top" width="21.060000000000002%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p411403151525"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p411403151525"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p411403151525"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="9.4%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p33323707151525"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p33323707151525"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p33323707151525"></a>unlimited</p>
</td>
</tr>
</tbody>
</table>

### 网卡参数配置

**表 4**  网卡参数配置

<a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_table6110995517616"></a>
<table><thead align="left"><tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_row1264128417616"><th class="cellrowborder" valign="top" width="14.511451145114512%" id="mcps1.2.5.1.1"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1731111217616"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1731111217616"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1731111217616"></a>参数名</p>
</th>
<th class="cellrowborder" valign="top" width="32.08320832083208%" id="mcps1.2.5.1.2"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6002283217616"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6002283217616"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6002283217616"></a>说明</p>
</th>
<th class="cellrowborder" valign="top" width="39.663966396639665%" id="mcps1.2.5.1.3"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p3001123717616"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p3001123717616"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p3001123717616"></a>预安装时是否由脚本自动设置</p>
</th>
<th class="cellrowborder" valign="top" width="13.74137413741374%" id="mcps1.2.5.1.4"><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1499111817616"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1499111817616"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1499111817616"></a>推荐取值</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_row632104417616"><td class="cellrowborder" valign="top" width="14.511451145114512%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p4224252617616"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p4224252617616"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p4224252617616"></a>rx</p>
</td>
<td class="cellrowborder" valign="top" width="32.08320832083208%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6620142817616"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6620142817616"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6620142817616"></a>网卡接收队列长度设置</p>
</td>
<td class="cellrowborder" valign="top" width="39.663966396639665%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6071548817616"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6071548817616"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p6071548817616"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.74137413741374%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1900746317616"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1900746317616"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p1900746317616"></a>4096</p>
</td>
</tr>
<tr id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_row23313038172018"><td class="cellrowborder" valign="top" width="14.511451145114512%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p8490754172018"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p8490754172018"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p8490754172018"></a>tx</p>
</td>
<td class="cellrowborder" valign="top" width="32.08320832083208%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p16662510172018"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p16662510172018"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p16662510172018"></a>网卡传送队列长度设置</p>
</td>
<td class="cellrowborder" valign="top" width="39.663966396639665%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p48712694172056"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p48712694172056"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p48712694172056"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.74137413741374%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p53414171172056"><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p53414171172056"></a><a name="zh-cn_topic_0241805805_zh-cn_topic_0085434661_zh-cn_topic_0059782062_p53414171172056"></a>4096</p>
</td>
</tr>
</tbody>
</table>

![](public_sys-resources/icon-notice.png) **须知：** 

-   网卡参数配置功能只针对万兆及万兆以上级别的业务网卡，即backIp1所绑定的网卡。

-   设置网卡参数的命令只有在设置成功后，才会被写入系统启动文件。执行失败的信息会被记入后台日志中。

